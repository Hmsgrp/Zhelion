<div *ngIf="hasError" class="alert alert-danger alert-dismissible fade show" role="alert">
  {{ErrorOccuredtext}}
  <button type="button" (click)="closeNotification()" class="close" data-dismiss="alert" aria-label="Close">
  <span aria-hidden="true">&times;</span>
</button>
</div>
<div class=row>
<div class="col-md-6">
  <div class="card card-custom card-stretch gutter-b">
    <!-- Header -->
    <div class="card-header align-items-center border-0 mt-4">
      <h3 class="card-title align-items-start flex-column">
        <span class="font-weight-bolder text-dark">User Management</span>
        <span class="text-muted mt-3 font-weight-bold font-size-sm"
          >Add New User and map roles</span
        >
      </h3>
    </div>
    <!-- Body -->
    <div class="card-body pt-4">

      <div *ngIf="showSuccessNotification" class="alert alert-success alert-dismissible fade show" role="alert">
        User Added Successfully.
         <button type="button" (click)="closeNotification()" class="close" data-dismiss="alert" aria-label="Close">
         <span aria-hidden="true">&times;</span>
       </button>
     </div>

      <form class="form"
      [formGroup]="UserRegistration"
      novalidate="novalidate"
      id="kt_role_user_form"
      (ngSubmit)="submitUser()">
        <div class="form-group">

          <label for="userName" class="font-weight-bolder">User Name</label>
          <input type="text" class="form-control" id="userName" 
          formControlName="userName" 
          autocomplete="off"
          aria-describedby="userName" placeholder="User Name">

          <ng-container
          [ngTemplateOutlet]="formError"
          [ngTemplateOutletContext]="{
            validation: 'required',
            message: 'User Name is required',
            control: UserRegistration.controls['userName']
          }"
        ></ng-container> 

          <ng-container
          [ngTemplateOutlet]="formError"
          [ngTemplateOutletContext]="{
            validation: 'minlength',
            message: 'User Name should have at least 5 symbols',
            control: UserRegistration.controls['userName']
          }"
           ></ng-container>

          <ng-container
          [ngTemplateOutlet]="formError"
          [ngTemplateOutletContext]="{
            validation: 'maxLength',
            message: 'User Name should have maximum 15 symbols',
            control: UserRegistration.controls['userName']
          }"
          ></ng-container>
          
        </div>
        <div class="form-group">
          <label for="password" class="font-weight-bolder">Password</label>
          <input type="password" class="form-control" id="password"
          formControlName="password" 
          autocomplete="off" 
          aria-describedby="password" 
          placeholder="Password">
        
          <ng-container
          [ngTemplateOutlet]="formError"
          [ngTemplateOutletContext]="{
            validation: 'required',
            message: 'Password is required',
            control: UserRegistration.controls['password']
          }"
        ></ng-container> 

          <ng-container
          [ngTemplateOutlet]="formError"
          [ngTemplateOutletContext]="{
            validation: 'minlength',
            message: 'Password should have at least 5 symbols',
            control: UserRegistration.controls['password']
          }"
           ></ng-container>

          <ng-container
          [ngTemplateOutlet]="formError"
          [ngTemplateOutletContext]="{
            validation: 'maxLength',
            message: 'Password should have maximum 15 symbols',
            control: UserRegistration.controls['password']
          }"
          ></ng-container>
        
        </div>
        <div class="form-group">
          <label for="mobileNumber" class="font-weight-bolder">Mobile Number</label>
          <input type="number" class="form-control" id="mobileNumber"
          formControlName="mobileNumber" 
          autocomplete="off"
          aria-describedby="mobileNumber" placeholder="Mobile Number">
        
          <ng-container
          [ngTemplateOutlet]="formError"
          [ngTemplateOutletContext]="{
            validation: 'required',
            message: 'Mobile Number is required',
            control: UserRegistration.controls['mobileNumber']
          }"
        ></ng-container> 

          <ng-container
          [ngTemplateOutlet]="formError"
          [ngTemplateOutletContext]="{
            validation: 'minlength',
            message: 'Mobile Number should have at least 5 symbols',
            control: UserRegistration.controls['mobileNumber']
          }"
           ></ng-container>

          <ng-container
          [ngTemplateOutlet]="formError"
          [ngTemplateOutletContext]="{
            validation: 'maxLength',
            message: 'Mobile Number should have maximum 15 symbols',
            control: UserRegistration.controls['mobileNumber']
          }"
          ></ng-container>
        </div>
        <div class="form-group">
          <label for="roleSelection" class="font-weight-bolder">Role Selection</label>
          <select id="roleSelection" formControlName="roleSelection"  class="form-control" data-role="select-dropdown">
            <option *ngFor="let role of (roles || []);  let i = index" [selected]="i == i" value={{role.roleId}}>
            {{role.roleName}}
          </option>
          </select>
          <ng-container
          [ngTemplateOutlet]="formError"
          [ngTemplateOutletContext]="{
            validation: 'required',
            message: 'Please select Role',
            control: UserRegistration.controls['roleSelection']
          }"
        ></ng-container> 
        </div>
        <div class="form-group">
          <label for="roleName" class="font-weight-bolder">Email ID</label>
        <input type="text" class="form-control" id="emailID" 
        formControlName="emailID" 
        autocomplete="off"
        aria-describedby="emailID" placeholder="Email ID">
 
        <ng-container
        [ngTemplateOutlet]="formError"
        [ngTemplateOutletContext]="{
          validation: 'required',
          message: 'Email is required',
          control: UserRegistration.controls['emailID']
        }"
      ></ng-container> 

      <ng-container
      [ngTemplateOutlet]="formError"
      [ngTemplateOutletContext]="{
        validation: 'email',
        message: 'Email is invalid',
        control: UserRegistration.controls['emailID']
      }"
    ></ng-container> 

        <ng-container
        [ngTemplateOutlet]="formError"
        [ngTemplateOutletContext]="{
          validation: 'minlength',
          message: 'Email should have at least 5 symbols',
          control: UserRegistration.controls['emailID']
        }"
         ></ng-container>

        <ng-container
        [ngTemplateOutlet]="formError"
        [ngTemplateOutletContext]="{
          validation: 'maxLength',
          message: 'Email should have maximum 25 symbols',
          control: UserRegistration.controls['emailID']
        }"
        ></ng-container>
      
        </div>
        <div class="form-check">
        </div>
        <button type="submit" class="btn btn-primary" [disabled]="UserRegistration.invalid">{{buttontext}}</button>
        &nbsp;
        <button *ngIf="isEdit" (click)="resetData()" type="submit" class="btn btn-danger">Cancel</button>
      </form>
    </div>
  </div>
</div>


<div class="col-md-6">
<div class="card card-custom card-stretch gutter-b">
  <!-- Header -->
  <div class="card-header border-0">
    <h3 class="card-title font-weight-bolder text-dark">Users</h3>
    <div class="card-toolbar">
    
    </div>
  </div>
  <!-- Body -->
  <div class="card-body pt-2"  style="height:80px; overflow:auto;">
    <div *ngIf="showUpdateNotification" class="alert alert-success alert-dismissible fade show" role="alert">
      {{updateMessage}}
       <button type="button" (click)="closeNotification()" class="close" data-dismiss="alert" aria-label="Close">
       <span aria-hidden="true">&times;</span>
     </button>
     </div>
    <!--begin::Item-->
    <div style="color: red;" *ngIf="users.length==0">
      <hr>   
      No records found
    </div>
    <div *ngFor="let user of users | paginate:{itemsPerPage: 5, currentPage:p}"  class="d-flex align-items-center mb-10">
      <!--begin::Symbol-->
      <div class="symbol symbol-40 symbol-light-success mr-5">
        <span class="symbol-label">
          <img
            alt="boy avatar"
            src="./assets/media/svg/avatars/009-boy-4.svg"
            class="h-75 align-self-end"
          />
        </span>
      </div>
      <!--end::Symbol-->

      <!--begin::Text-->
      <div class="d-flex flex-column flex-grow-1 font-weight-bold">
        <a href="#" class="text-dark text-hover-primary mb-1 font-size-lg"
          >{{user.userName}}</a>
        <span class="text-muted">Email:{{user.emailId}}</span>
      </div>
      <!--end::Text-->
        <div> 
            <button title="Edit Role" class="btn btn-icon btn-light btn-hover-primary btn-sm mx-3"
            (click)="editUser(user.userID,user.userName,user.password,user.mobileNumber,user.roleId,user.emailId)">
            <span [inlineSVG]="'./assets/media/svg/icons/Communication/Write.svg'" cacheSVG="true"
              class="svg-icon svg-icon-md svg-icon-primary">
            </span>
          </button>
          <button title="Delete Role" class="btn btn-icon btn-light btn-hover-danger btn-sm"
            (click)="deleteUser(user.userID)">
            <span [inlineSVG]="'./assets/media/svg/icons/General/Trash.svg'" cacheSVG="true"
              class="svg-icon svg-icon-md svg-icon-danger">
            </span>
          </button>
        </div>
        <hr>
        
<!-- src=
  "./assets/media/svg/avatars/006-girl-3.svg" -->
    </div>
  
    <!--end::Item-->
  </div>
  <hr>
   <div id="pagination" class="pagination justify-content-end marginRight10px">
       <pagination-controls (pageChange)="p=$event"></pagination-controls>
   </div> 
</div>
</div>
</div>


<ng-template
#formError
let-control="control"
let-message="message"
let-validation="validation"
>
<ng-container
  *ngIf="control.hasError(validation) && (control.dirty || control.touched)"
>
  <div class="fv-plugins-message-container">
    <div class="fv-help-block">
      {{ message }}
    </div>
  </div>
</ng-container>
</ng-template>